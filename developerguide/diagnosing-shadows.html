<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Diagnosing problems with shadows - AWS IoT Core</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="assets" />
      <meta name="target_state" content="diagnosing-shadows" />
      <meta name="default_state" content="diagnosing-shadows" />
      <link rel="icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/iot/latest/developerguide/diagnosing-shadows.html" />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS IoT Core" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="AWS IoT provides secure, bi-directional communication between Internet-connected devices such as sensors, actuators, embedded micro-controllers, or smart appliances and the AWS Cloud. This enables you to collect telemetry data from multiple devices, and store and analyze the data. You can also create applications that enable your users to control these devices from their phones or tablets." />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="IoT Docs" />
      <meta name="this_doc_product" content="AWS IoT Core" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="assets/css/vendor4.css" rel="stylesheet" />
      <link href="assets/css/awsdocs-common.css" rel="stylesheet" /><script type="text/javascript" src="assets/js/vendor3.js" defer=""></script><script type="text/javascript" src="assets/js/vendor4.js" defer=""></script><script type="text/javascript" src="assets/js/vendor1.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-common.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-doc-app.js" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Diagnosing problems with shadows - AWS IoT Core</title>
                        <meta name="pdf" content="iot-dg.pdf#diagnosing-shadows" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07JBRCWWZ" />
                        <meta name="github" content="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/diagnosing-shadows.md" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=210" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT%20Docs&amp;topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/diagnosing-shadows.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/diagnosing-shadows.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/diagnosing-shadows.html" />
                        <meta name="keywords" content="AWS IoT,IoT,Internet of Things" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="iot-dg.pdf#diagnosing-shadows" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a target="_blank" rel="noopener noreferrer" href="https://www.amazon.com/dp/B07JBRCWWZ" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/diagnosing-shadows.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iot/index.html">AWS IoT Core</a><a href="what-is-aws-iot.html">Developer Guide</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="diagnosing-shadows">Diagnosing problems with shadows </h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p></p><a id="diagnosing-shadow-table"></a><div class="table-container">
                                    <div class="table-contents">
                                       <table id="w332aac61c11b5">
                                          <thead>
                                             <tr>
                                                <th class="table-header" colspan="100%">
                                                   <div class="title">Diagnosing shadows</div>
                                                </th>
                                             </tr>
                                             
                                             <tr>
                                                
                                                <th>Issue</th>
                                                
                                                <th>Troubleshooting guidelines</th>
                                                
                                             </tr>
                                             
                                          </thead>
                                          
                                          <tr>
                                             
                                             <td>A device's shadow document is rejected with <code class="code">Invalid JSON
                                                   document</code>.
                                             </td>
                                             
                                             <td>If you are unfamiliar with JSON, modify the examples provided in this guide for
                                                your own use. For more information, see <a href="./device-shadow-document.html#device-shadow-document-syntax">Shadow document examples</a>.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>I submitted correct JSON, but none or only parts of it are stored in the device's
                                                shadow document.
                                             </td>
                                             
                                             <td>Be sure you are following the JSON formatting guidelines. Only JSON fields in the
                                                <code class="code">desired</code> and <code class="code">reported</code> sections are stored. JSON content
                                                (even if formally correct) outside of those sections is ignored.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>I received an error that the device's shadow exceeds the allowed size.</td>
                                             
                                             <td>The device's shadow supports 8 KB of data only. Try shortening field names inside
                                                of your JSON document or simply create more shadows by creating more things. A device
                                                can have an unlimited number of things/shadows associated with it. The only
                                                requirement is that each thing name must be unique in your account.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>When I receive a device's shadow, it is larger than 8 KB. How can this
                                                happen?
                                             </td>
                                             
                                             <td>Upon receipt, the AWS IoT service adds metadata to the device's shadow. The service
                                                includes this data in its response, but it does not count toward the limit of 8 KB.
                                                Only the data for <code class="code">desired</code> and <code class="code">reported</code> state inside the
                                                state document sent to the device's shadow counts toward the limit.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>My request has been rejected due to incorrect version. What should I do?</td>
                                             
                                             <td>Perform a GET operation to sync to the latest state document version. When using
                                                MQTT, subscribe to the ./update/accepted topic to be notified about state changes
                                                and
                                                receive the latest version of the JSON document.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>The timestamp is off by several seconds.</td>
                                             
                                             <td>The timestamp for individual fields and the whole JSON document is updated when
                                                the document is received by the AWS IoT service or when the state document is published
                                                onto the ./update/accepted and ./update/delta message. Messages can be delayed over
                                                the network, which can cause the timestamp to be off by a few seconds.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>My device can publish and subscribe on the corresponding shadow topics, but when
                                                I attempt to update the shadow document over the HTTP REST API, I get HTTP
                                                403.
                                             </td>
                                             
                                             <td>Be sure you have created policies in IAM to allow access to these topics and
                                                for the corresponding action (UPDATE/GET/DELETE) for the credentials you are using.
                                                IAM policies and certificate policies are independent.
                                             </td>
                                             
                                          </tr>
                                          
                                          <tr>
                                             
                                             <td>Other issues.</td>
                                             
                                             <td>The Device Shadow service logs errors to CloudWatch Logs. To identify device and
                                                configuration issues, enable CloudWatch Logs and view the logs for debug information.
                                                
                                             </td>
                                             
                                          </tr>
                                          
                                       </table>
                                    </div>
                                 </div>
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the Amazon Web Services Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="./diagnosing-rules.html">Diagnosing rules issues</div>
                                    <div id="next" class="next-link" accesskey="n" href="./diagnosing-salesforce.html">Diagnosing Salesforce action
                                       issues
                                    </div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/diagnosing-shadows.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/diagnosing-shadows.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS IoT Core';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>
</html>