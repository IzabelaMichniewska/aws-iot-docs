<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>ML Detect guide - AWS IoT Core</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="assets" />
      <meta name="target_state" content="dd-detect-ml-getting-started" />
      <meta name="default_state" content="dd-detect-ml-getting-started" />
      <link rel="icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/iot/latest/developerguide/dd-detect-ml-getting-started.html" />
      <meta name="description" content="Get started with AWS IoT Device Defender ML Detect." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS IoT Core" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="AWS IoT provides secure, bi-directional communication between Internet-connected devices such as sensors, actuators, embedded micro-controllers, or smart appliances and the AWS Cloud. This enables you to collect telemetry data from multiple devices, and store and analyze the data. You can also create applications that enable your users to control these devices from their phones or tablets." />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="IoT Docs" />
      <meta name="this_doc_product" content="AWS IoT Core" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="assets/css/vendor4.css" rel="stylesheet" />
      <link href="assets/css/awsdocs-common.css" rel="stylesheet" /><script type="text/javascript" src="assets/js/vendor3.js" defer=""></script><script type="text/javascript" src="assets/js/vendor4.js" defer=""></script><script type="text/javascript" src="assets/js/vendor1.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-common.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-doc-app.js" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>ML Detect guide - AWS IoT Core</title>
                        <meta name="pdf" content="iot-dg.pdf#dd-detect-ml-getting-started" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07JBRCWWZ" />
                        <meta name="github" content="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/dd-detect-ml-getting-started.md" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=210" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT%20Docs&amp;topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-ml-getting-started.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-ml-getting-started.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-ml-getting-started.html" />
                        <meta name="keywords" content="AWS IoT,IoT,Internet of Things" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="iot-dg.pdf#dd-detect-ml-getting-started" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a target="_blank" rel="noopener noreferrer" href="https://www.amazon.com/dp/B07JBRCWWZ" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/dd-detect-ml-getting-started.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iot/index.html">AWS IoT Core</a><a href="what-is-aws-iot.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#ml-detect-prereqs">Prerequisites</a><a href="#dd-detect-ml-console">How to use ML Detect in the console</a><a href="#dd-detect-ml-cli">How to use ML Detect with the CLI</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="dd-detect-ml-getting-started">ML Detect guide</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>In this Getting Started guide, you create an ML Detect Security Profile that uses
                                    machine
                                    learning (ML) to create models of expected behavior based on historical metric data
                                    from
                                    your devices. While ML Detect is creating the ML model, you can monitor its progress.
                                    After
                                    the ML model is built, you can view and investigate alarms on an ongoing basis and
                                    mitigate
                                    identified issues.
                                 </p>
                                 <p>For more information about ML Detect and its API and CLI commands, see <a href="./dd-detect-ml.html">ML Detect</a>.
                                 </p>
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>This chapter contains the following sections:</strong></p>
                                    <ul>
                                       <li><a href="#ml-detect-prereqs">Prerequisites</a></li>
                                       <li><a href="#dd-detect-ml-console">How to use ML Detect in the console</a></li>
                                       <li><a href="#dd-detect-ml-cli">How to use ML Detect with the CLI</a></li>
                                    </ul>
                                 </div>
                                 
                                 <h2 id="ml-detect-prereqs">Prerequisites</h2>
                                 
                                 <div class="itemizedlist">
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>An AWS account. If you don't have this, see <a href="https://docs.aws.amazon.com/iot/latest/developerguide/dd-setting-up.html">Setting
                                                up</a>.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h2 id="dd-detect-ml-console">How to use ML Detect in the console</h2>
                                 
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Tutorials</strong></p>
                                    <ul>
                                       <li><a href="#enable-ml-detect-console">Enable ML Detect</a></li>
                                       <li><a href="#monitor-ml-models-console">Monitor your ML model status</a></li>
                                       <li><a href="#review-ml-alarms-console">Review your ML Detect alarms</a></li>
                                       <li><a href="#fine-tune-ml-models-console">Fine-tune your ML alarms</a></li>
                                       <li><a href="#mitigate-ml-issues-console">Mitigate identified device issues</a></li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h3 id="enable-ml-detect-console">Enable ML Detect</h3>
                                 
                                 <p>The following procedures detail how to set up ML Detect in the console.</p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>First, make sure your devices will create the minimum datapoints required
                                             as defined in <a href="./dd-detect-ml.html#dd-detect-ml-requirements">ML Detect minimum
                                                requirements</a> for ongoing training and refreshing of the model.
                                             For data collection to progress, ensure your Security Profile is attached to
                                             a target, which can be a thing or thing group.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>. Choose <b>Detect</b>,
                                             <b>Security profiles</b>, <b>Create security
                                                profile</b>, and then <b>Create ML anomaly Detect
                                                profile</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Set basic configurations</b> page, do the
                                             following.
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Target</b>, choose your target device
                                                      groups.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Security profile name</b>, enter a name for
                                                      your Security Profile.
                                                   </p> 
                                                   
                                                </li>
                                                <li class="listitem">
                                                   <p>(Optional) Under <b>Description</b> you can write in a short description for the
                                                      ML profile.
                                                   </p>
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Selected metric behaviors in Security Profile</b>, choose the
                                                      metrics you'd like to monitor.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-set-basic.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p>When you're done, choose <b>Next</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Set SNS (optional)</b> page, specify an SNS topic
                                             for alarm notifications when a device violates a behavior in your profile.
                                             Choose an IAM role you will use to publish to the selected SNS topic.
                                          </p>
                                          
                                          <p>If you don't have an SNS role yet, use the following steps to create a
                                             role with the proper permissions and trust relationships required. 
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                              
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>Navigate to the <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>IAM console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. In the navigation pane, choose
                                                      <b>Roles</b> and then choose <b>Create
                                                         role</b>.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Select type of trusted entity</b>, select
                                                      <b>AWS Service</b>. Then, under <b>Choose a
                                                         use case</b>, choose <b>IoT</b> and under
                                                      <b>Select your use case</b>, choose <b>IoT
                                                         - Device Defender Mitigation Actions</b>. When you're
                                                      done, choose <b>Next: Permissions</b>.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Attached permissions policies</b>, ensure
                                                      that
                                                      <b>AWSIoTDeviceDefenderPublishFindingsToSNSMitigationAction</b>
                                                      is selected, and then choose <b>Next:
                                                         Tags</b>.
                                                   </p>
                                                   
                                                   <div class="mediaobject">
                                                       
                                                      <img src="images/dd-ml-sns-findings.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                                       
                                                      
                                                   </div>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Add tags (optional)</b>, you can add any
                                                      tags you'd like to associate with your role. When you're done,
                                                      choose <b>Next: Review</b>.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Under <b>Review</b>, give your role a name and
                                                      ensure that
                                                      <b>AWSIoTDeviceDefenderPublishFindingsToSNSMitigationAction</b>
                                                      is listed under <b>Permissions</b> and <b>AWS
                                                         service: iot.amazonaws.com</b> is listed under
                                                      <b>Trust relationships</b>. When you're done,
                                                      choose <b>Create role</b>.
                                                   </p>
                                                   
                                                   <div class="mediaobject">
                                                       
                                                      <img src="images/dd-ml-detect-permissions.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                                       
                                                      
                                                   </div>
                                                   
                                                   <div class="mediaobject">
                                                       
                                                      <img src="images/dd-ml-detect-trust-relationships.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                                       
                                                      
                                                   </div>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Edit Metric behavior</b> page, you can
                                             customize your ML behavior settings. 
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-update-config.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>When you're done, choose <b>Next</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Review configuration</b> page, verify the
                                             behaviors you'd like machine learning to monitor, and then choose
                                             <b>Next</b>.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-review-config.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p></p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>After you've created your Security Profile, you're redirected to the
                                             <b>Security Profiles</b> page, where the newly created
                                             Security Profile appears.
                                          </p>
                                          
                                          <div class="awsdocs-note">
                                             <div class="awsdocs-note-title">
                                                <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                             <div class="awsdocs-note-text">
                                                <p>The initial ML model training and creation takes 14 days to complete.
                                                   You can expect to see alarms after it's complete, if there is any
                                                   anomalous activity on your devices.
                                                </p>
                                             </div>
                                          </div>
                                          
                                       </li>
                                    </ol>
                                 </div> 
                                  
                                  
                                 
                                 <h3 id="monitor-ml-models-console">Monitor your ML model status</h3>
                                 
                                 <div class="procedure">
                                    <p>While your ML models are in the initial training period, you can monitor their
                                       progress at any time by taking the following steps.
                                    </p>
                                    <ol>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Security profiles</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Security Profiles</b> page, choose the Security
                                             Profile you'd like to review. Then, choose <b>Behaviors and ML
                                                training</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Behaviors and ML training</b> page, check the
                                             training progress of your ML models.
                                          </p>
                                          
                                          <p>After your model status is <b>Active</b>, it'll start making
                                             Detect decisions based on your usage and update the profile every
                                             day.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-active-state.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                 
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>If your model doesn't progress as expected, make sure your devices are meeting
                                          the <a href="./dd-detect-ml.html#dd-detect-ml-requirements">Minimum requirements</a>.
                                       </p>
                                    </div>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="review-ml-alarms-console">Review your ML Detect alarms</h3>
                                 
                                 <div class="procedure">
                                    <p>After your ML models are built and ready for data inference, you can regularly
                                       view and investigate alarms that are identified by the models.
                                    </p>
                                    <ol>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Alarms</b>.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-alarms.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>If you navigate to the <b>History</b> tab, you can also view
                                             details about your devices that are no longer in alarms.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-history-alarm.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p>To get more information, under <b>Manage</b> choose
                                             <b>Things</b>, chose the thing you'd like to see more
                                             details for, and then navigate to <b>Defender metrics</b>. You
                                             can access the <b>Defender metrics graph</b> and perform your
                                             investigation on anything in alarm from the <b>Active</b> tab.
                                             In this case, the graph shows a spike in message size, which triggered the
                                             alarm. You can see the alarm subsequently cleared.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-defender-metrics.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="fine-tune-ml-models-console">Fine-tune your ML alarms</h3>
                                 
                                 <div class="procedure">
                                    <p>After your ML models are built and ready for data evaluations, you can update
                                       your Security Profile's ML behavior settings to change the configuration. The
                                       following procedure shows you how to update your Security Profile's ML behavior
                                       settings in the AWS CLI.
                                    </p>
                                    <ol>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Security profiles</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Security Profiles</b> page, select the check box
                                             next to the Security Profile you'd like to review. Then, choose
                                             <b>Actions</b>, <b>Edit</b>. 
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-fine-tune.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Under <b>Set basic configurations</b>, you can adjust
                                             Security Profile target thing groups or change what metrics you want to
                                             monitor.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-set-basic.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>You can update any of the following by navigating to <b>Edit metric
                                                behaviors</b>.
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>Your ML model datapoints required to trigger alarm</p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Your ML model datapoints required to clear alarm</p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Your ML Detect confidence level</p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Your ML Detect notifications (for example,
                                                      <b>Not suppressed</b>, <b>Suppressed</b>)
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-update-config-2.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="mitigate-ml-issues-console">Mitigate identified device issues</h3>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p><em>(Optional)</em> Before setting up quarantine mitigation
                                             actions, let's set up a quarantine group where we'll move the device that's
                                             in violation to. You can also use an existing group.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Navigate to <b>Manage</b>, <b>Thing
                                                groups</b>, and then <b>Create Thing Group</b>. Name
                                             your thing group. For this tutorial, we'll name our thing group
                                             <code class="code">Quarantine_group</code>. Under <b>Thing
                                                group</b>, <b>Security</b>, apply the following
                                             policy to the thing group.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Deny",
      "Action": "iot:*",
      "Resource": "*",
    }
  ]
}
</code></pre>
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-create-thing-group.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p>When you're done, choose <b>Create thing group</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Now that we've created a thing group, let's create a mitigation action
                                             that move devices that in alarm into the
                                             <code class="code">Quarantine_group</code>.
                                          </p>
                                          
                                          <p>Under <b>Defend</b>, <b>Mitigation
                                                actions</b>, choose <b>Create</b>.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-miti-create.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Create a new mitigation action</b> page, enter the
                                             following information.
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p><b>Action name</b>: Give your mitigation action a
                                                      name, such as <code class="userinput">Quarantine_action</code>.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p><b>Action type</b>: Choose the type of action. We'll
                                                      choose <b>Add things to thing group (Audit or Detect
                                                         mitigation)</b>.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p><b>Action execution role</b>: Create a role or
                                                      choose an existing role if you created one earlier.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p><b>Parameters</b>: Choose a thing group. We can use
                                                      <code class="code">Quarantine_group</code>, which we created
                                                      earlier.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-miti-create-form.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p>When you're done, choose <b>Save</b>. You now have a
                                             mitigation action that moves devices in alarm to a quarantine thing group,
                                             and a mitigation action to isolate the device while you investigate.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Navigate to <b>Defender</b>, <b>Detect</b>,
                                             <b>Alarms</b>. You can see which devices are in alarm
                                             state under <b>Active</b>.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-alarms.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p>Select the device you want to move to the quarantine group and choose
                                             <b>Start Mitigation Actions</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Under <b>Start mitigation actions</b>, <b>Start
                                                Actions</b> select the mitigation action you created earlier. For
                                             example, we'll choose <code class="userinput">Quarantine_action</code>, then choose
                                             <b>Start</b>. The Action Tasks page opens.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-start-action.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>The device is now isolated in <code class="userinput">Quarantine_group</code> and
                                             you can investigate the root cause of the issue that set off the alarm.
                                             After you complete the investigation, you can move the device out of the
                                             thing group or take further actions.
                                          </p>
                                          
                                          <div class="mediaobject">
                                              
                                             <img src="images/dd-ml-action-tasks.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
                                              
                                             
                                          </div>
                                          
                                          <p></p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                   
                                  
                                 
                                 <h2 id="dd-detect-ml-cli">How to use ML Detect with the CLI</h2>
                                 
                                 <p>The following shows you how to set up ML Detect using the CLI.</p>
                                 
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Tutorials</strong></p>
                                    <ul>
                                       <li><a href="#enable-ml-detect-cli">Enable ML Detect</a></li>
                                       <li><a href="#monitor-ml-models-cli">Monitor your ML model status</a></li>
                                       <li><a href="#review-ml-alarms-cli">Review your ML Detect alarms</a></li>
                                       <li><a href="#fine-tune-ml-models-cli">Fine-tune your ML alarms</a></li>
                                       <li><a href="#mitigate-issues-cli">Mitigate identified device issues</a></li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h3 id="enable-ml-detect-cli">Enable ML Detect</h3>
                                 
                                 <div class="procedure">
                                    <p>The following procedure shows you how to enable ML Detect in the AWS CLI. </p>
                                    <ol>
                                       <li>
                                          
                                          <p>Make sure your devices will create the minimum datapoints required as
                                             defined in <a href="./dd-detect-ml.html#dd-detect-ml-requirements">ML Detect minimum
                                                requirements</a> for ongoing training and refreshing of the model.
                                             For data collection to progress, ensure your things are in a thing group
                                             attached to a Security Profile.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Create an ML Detect Security Profile by using the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/create-security-profile.html">create-security-profile</a></code> command. The following
                                             example creates a Security Profile named
                                             <code class="replaceable">security-profile-for-smart-lights</code> that checks
                                             for number of messages sent, number of authorization failures, number of
                                             connection attempts, and number of disconnects. The example uses
                                             <code class="code">mlDetectionConfig</code> to establish that the metric will use the
                                             ML Detect model.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot create-security-profile \
    --security-profile-name <code class="replaceable">security-profile-for-smart-lights</code> \
    --behaviors \
     '[<span>{</span>
    "name": "num-messages-sent-ml-behavior",
    "metric": "aws:num-messages-sent",
    "criteria": <span>{</span>
      "consecutiveDatapointsToAlarm": 1,
      "consecutiveDatapointsToClear": 1,
      "mlDetectionConfig": <span>{</span>
        "confidenceLevel": "HIGH"
      }
    },
    "suppressAlerts": true
  },
  <span>{</span>
    "name": "num-authorization-failures-ml-behavior",
    "metric": "aws:num-authorization-failures",
    "criteria": <span>{</span>
      "consecutiveDatapointsToAlarm": 1,
      "consecutiveDatapointsToClear": 1,
      "mlDetectionConfig": <span>{</span>
        "confidenceLevel": "HIGH"
      }
    },
    "suppressAlerts": true
  },
  <span>{</span>
    "name": "num-connection-attempts-ml-behavior",
    "metric": "aws:num-connection-attempts",
    "criteria": <span>{</span>
      "consecutiveDatapointsToAlarm": 1,
      "consecutiveDatapointsToClear": 1,
      "mlDetectionConfig": <span>{</span>
        "confidenceLevel": "HIGH"
      }
    },
    "suppressAlerts": true
  },
  <span>{</span>
    "name": "num-disconnects-ml-behavior",
    "metric": "aws:num-disconnects",
    "criteria": <span>{</span>
      "consecutiveDatapointsToAlarm": 1,
      "consecutiveDatapointsToClear": 1,
      "mlDetectionConfig": <span>{</span>
        "confidenceLevel": "HIGH"
      }
    },
    "suppressAlerts": true
  }]'</code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
    "securityProfileArn": "arn:aws:iot:<code class="replaceable">eu-west-1</code>:<code class="replaceable">123456789012</code>:securityprofile/<code class="replaceable">security-profile-for-smart-lights</code>"
  }</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>Next, associate your Security Profile with one or multiple thing groups.
                                             Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/attach-security-profile.html">attach-security-profile</a></code> command to attach a thing
                                             group to your Security Profile. The following example associates a thing
                                             group named <code class="replaceable">ML_Detect_beta_static_group</code> with the
                                             <code class="replaceable">security-profile-for-smart-lights</code> Security
                                             Profile.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot attach-security-profile \
--security-profile-name <code class="replaceable">security-profile-for-smart-lights</code> \
--security-profile-target-arn arn:aws:iot:<code class="replaceable">eu-west-1</code>:<code class="replaceable">123456789012</code>:thinggroup/<code class="replaceable">ML_Detect_beta_static_group</code> </code></pre>
                                          <p>Output:</p>
                                          
                                          <p>None.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>After you've created your complete Security Profile, the ML model begins
                                             training. The initial ML model training and building takes 14 days to
                                             complete. After 14 days, if there's anomalous activity on your device, you
                                             can expect to see alarms.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="monitor-ml-models-cli">Monitor your ML model status</h3>
                                 
                                 <div class="procedure">
                                    <p>The following procedure shows you how to monitor your ML models in-progress
                                       training.
                                    </p>
                                    <ul>
                                       <li>
                                          
                                          <p>Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/get-behavior-model-training-summaries.html">get-behavior-model-training-summaries</a></code> command to
                                             view your ML model's progress. The following example gets the ML model
                                             training progress summary for the
                                             <code class="replaceable">security-profile-for-smart-lights</code> Security
                                             Profile. <code class="code">modelStatus</code> shows you if a model has completed
                                             training or is still pending build for a particular behavior.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot get-behavior-model-training-summaries \
   --security-profile-name <code class="replaceable">security-profile-for-smart-lights</code> </code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "summaries": [
        <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "Messages_sent_ML_behavior",
            "trainingDataCollectionStartDate": "2020-11-30T14:00:00-08:00",
            "modelStatus": "ACTIVE",
            "datapointsCollectionPercentage": 29.408,
            "lastModelRefreshDate": "2020-12-07T14:35:19.237000-08:00"
        },
        <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "Messages_received_ML_behavior",
            "modelStatus": "PENDING_BUILD",
            "datapointsCollectionPercentage": 0.0
        },
        <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "Authorization_failures_ML_behavior",
            "trainingDataCollectionStartDate": "2020-11-30T14:00:00-08:00",
            "modelStatus": "ACTIVE",
            "datapointsCollectionPercentage": 35.464,
            "lastModelRefreshDate": "2020-12-07T14:29:44.396000-08:00"
        },
        <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "Message_size_ML_behavior",
            "trainingDataCollectionStartDate": "2020-11-30T14:00:00-08:00",
            "modelStatus": "ACTIVE",
            "datapointsCollectionPercentage": 29.332,
            "lastModelRefreshDate": "2020-12-07T14:30:44.113000-08:00"
        },
        <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "Connection_attempts_ML_behavior",
            "trainingDataCollectionStartDate": "2020-11-30T14:00:00-08:00",
            "modelStatus": "ACTIVE",
            "datapointsCollectionPercentage": 32.891999999999996,
            "lastModelRefreshDate": "2020-12-07T14:29:43.121000-08:00"
        },
        <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "Disconnects_ML_behavior",
            "trainingDataCollectionStartDate": "2020-11-30T14:00:00-08:00",
            "modelStatus": "ACTIVE",
            "datapointsCollectionPercentage": 35.46,
            "lastModelRefreshDate": "2020-12-07T14:29:55.556000-08:00"
        }
    ]
}</code></pre>
                                          </li>
                                    </ul>
                                 </div>
                                 
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>If your model doesn't progress as expected, make sure your devices are meeting
                                          the <a href="./dd-detect-ml.html#dd-detect-ml-requirements">Minimum requirements</a>.
                                       </p>
                                    </div>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="review-ml-alarms-cli">Review your ML Detect alarms</h3>
                                 
                                 <div class="procedure">
                                    <p>After your ML models are built and ready for data evaluations, you can
                                       regularly view any alarms that are inferred by the models. The following
                                       procedure shows you how to view your alarms in the AWS CLI.
                                    </p>
                                    <ul>
                                       <li>
                                          
                                          <p>To see all active alarms, use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-active-violations.html">list-active-violations</a></code> command.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">aws iot list-active-violations \
--max-results 2 </code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "activeViolations": []
}</code></pre>
                                          <p>Alternatively, you can view all violations discovered during a given time
                                             period by using the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-violation-events.html">list-violation-events</a></code> command. The following example
                                             lists violation events from September 22, 2020 5:42:13 GMT to October 26,
                                             2020 5:42:13 GMT.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot list-violation-events \
    --start-time <code class="replaceable">1599500533</code> \ 
    --end-time <code class="replaceable">1600796533</code> \
    --max-results <code class="replaceable">2</code> </code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "violationEvents": [
        <span>{</span>
            "violationId": "1448be98c09c3d4ab7cb9b6f3ece65d6",
            "thingName": "lightbulb-1",
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behavior": <span>{</span>
                "name": "LowConfidence_MladBehavior_MessagesSent",
                "metric": "aws:num-messages-sent",
                "criteria": <span>{</span>
                    "consecutiveDatapointsToAlarm": 1,
                    "consecutiveDatapointsToClear": 1,
                    "mlDetectionConfig": <span>{</span>
                        "confidenceLevel": "HIGH"
                    }
                },
                "suppressAlerts": true
            },
            "violationEventType": "alarm-invalidated",
            "violationEventTime": 1600780245.29
        },
        <span>{</span>
            "violationId": "df4537569ef23efb1c029a433ae84b52",
            "thingName": "lightbulb-2",
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behavior": <span>{</span>
                "name": "LowConfidence_MladBehavior_MessagesSent",
                "metric": "aws:num-messages-sent",
                "criteria": <span>{</span>
                    "consecutiveDatapointsToAlarm": 1,
                    "consecutiveDatapointsToClear": 1,
                    "mlDetectionConfig": <span>{</span>
                        "confidenceLevel": "HIGH"
                    }
                },
                "suppressAlerts": true
            },
            "violationEventType": "alarm-invalidated",
            "violationEventTime": 1600780245.281
        }
    ],
    "nextToken": "Amo6XIUrsOohsojuIG6TuwSR3X9iUvH2OCksBZg6bed2j21VSnD1uP1pflxKX1+a3cvBRSosIB0xFv40kM6RYBknZ/vxabMe/ZW31Ps/WiZHlr9Wg7R7eEGli59IJ/U0iBQ1McP/ht0E2XA2TTIvYeMmKQQPsRj/eoV9j7P/wveu7skNGepU/mvpV0O2Ap7hnV5U+Prx/9+iJA/341va+pQww7jpUeHmJN9Hw4MqW0ysw0Ry3w38hOQWEpz2xwFWAxAARxeIxCxt5c37RK/lRZBlhYqoB+w2PZ74730h8pICGY4gktJxkwHyyRabpSM/G/f5DFrD9O5v8idkTZzBxW2jrbzSUIdafPtsZHL/yAMKr3HAKtaABz2nTsOBNre7X2d/jIjjarhon0Dh9l+8I9Y5Ey+DIFBcqFTvhibKAafQt3gs6CUiqHdWiCenfJyb8whmDE2qxvdxGElGmRb+k6kuN5jrZxxw95gzfYDgRHv11iEn8h1qZLD0czkIFBpMppHj9cetHPvM+qffXGAzKi8tL6eQuCdMLXmVE3jbqcJcjk9ItnaYJi5zKDz9FVbrz9qZZPtZJFHp"
}</code></pre>
                                          </li>
                                    </ul>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="fine-tune-ml-models-cli">Fine-tune your ML alarms</h3>
                                 
                                 <div class="procedure">
                                    <p>Once your ML models are built and ready for data evaluations, you can update
                                       your Security Profile's ML behavior settings to change the configuration. The
                                       following procedure shows you how to update your Security Profile's ML behavior
                                       settings in the AWS CLI.
                                    </p>
                                    <ul>
                                       <li>
                                          
                                          <p>To change your Security Profile's ML behavior settings, use the
                                             <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/update-security-profile.html">update-security-profile</a></code> command. The following
                                             example updates the
                                             <code class="replaceable">security-profile-for-smart-lights</code> Security
                                             Profile's behaviors by changing the <code class="code">confidenceLevel</code> of a few of
                                             the behaviors and unsuppresses notifications for all behaviors.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot update-security-profile \
    --security-profile-name <code class="replaceable">security-profile-for-smart-lights</code> \
    --behaviors \
     '[<span>{</span>
      "name": "num-messages-sent-ml-behavior",
      "metric": "aws:num-messages-sent",
      "criteria": <span>{</span>
          "mlDetectionConfig": <span>{</span>
              "confidenceLevel" : "HIGH"
          }
      },
      "suppressAlerts": false
  },
  <span>{</span>
      "name": "num-authorization-failures-ml-behavior",
      "metric": "aws:num-authorization-failures",
      "criteria": <span>{</span>
          "mlDetectionConfig": <span>{</span>
              "confidenceLevel" : "HIGH"
          }
      },
      "suppressAlerts": false
  },
  <span>{</span>
      "name": "num-connection-attempts-ml-behavior",
      "metric": "aws:num-connection-attempts",
      "criteria": <span>{</span>
          "mlDetectionConfig": <span>{</span>
              "confidenceLevel" : "HIGH"
          }
      },
      "suppressAlerts": false
  },
  <span>{</span>
      "name": "num-disconnects-ml-behavior",
      "metric": "aws:num-disconnects",
      "criteria": <span>{</span>
          "mlDetectionConfig": <span>{</span>
              "confidenceLevel" : "LOW"
          }
      },
      "suppressAlerts": false

  }]' </code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"> <span>{</span>
    "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
    "securityProfileArn": "arn:aws:iot:eu-west-1:<code class="replaceable">123456789012</code>:securityprofile/<code class="replaceable">security-profile-for-smart-lights</code>",
    "behaviors": [
        <span>{</span>
            "name": "num-messages-sent-ml-behavior",
            "metric": "aws:num-messages-sent",
            "criteria": <span>{</span>
                "mlDetectionConfig": <span>{</span>
                    "confidenceLevel": "HIGH"
                }
            }
        },
        <span>{</span>
            "name": "num-authorization-failures-ml-behavior",
            "metric": "aws:num-authorization-failures",
            "criteria": <span>{</span>
                "mlDetectionConfig": <span>{</span>
                    "confidenceLevel": "HIGH"
                }
            }
        },
        <span>{</span>
            "name": "num-connection-attempts-ml-behavior",
            "metric": "aws:num-connection-attempts",
            "criteria": <span>{</span>
                "mlDetectionConfig": <span>{</span>
                    "confidenceLevel": "HIGH"
                }
            },
            "suppressAlerts": false
        },
        <span>{</span>
            "name": "num-disconnects-ml-behavior",
            "metric": "aws:num-disconnects",
            "criteria": <span>{</span>
                "mlDetectionConfig": <span>{</span>
                    "confidenceLevel": "LOW"
                }
            },
            "suppressAlerts": true
        }
    ],
    "version": 2,
    "creationDate": 1600799559.249,
    "lastModifiedDate": 1600800516.856
}</code></pre>
                                          </li>
                                    </ul>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="mitigate-issues-cli">Mitigate identified device issues</h3>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/create-thing-group.html">create-thing-group</a></code> command to create a thing group
                                             for the mitigation action. In the following example, we create a thing group
                                             called <b>ThingGroupForDetectMitigationAction</b>.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot create-thing-group —thing-group-name <code class="replaceable">ThingGroupForDetectMitigationAction</code></code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
 "thingGroupName": "<code class="replaceable">ThingGroupForDetectMitigationAction</code>",
 "thingGroupArn": "arn:aws:iot:<code class="replaceable">us-east-1</code>:<code class="replaceable">123456789012</code>:thinggroup/<code class="replaceable">ThingGroupForDetectMitigationAction</code>",
 "thingGroupId": "4139cd61-10fa-4c40-b867-0fc6209dca4d"
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>Next, use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/create-mitigation-action.html">create-mitigation-action</a></code> command to create a
                                             mitigation action. In the following example, we create a mitigation action
                                             called <b>detect_mitigation_action</b> with the ARN of the IAM
                                             role that is used to apply the mitigation action. We also define the type of
                                             action and the parameters for that action. In this case, our mitigation will
                                             move things to our previously created thing group called
                                             <b>ThingGroupForDetectMitigationAction</b>.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot create-mitigation-action --action-name <code class="replaceable">detect_mitigation_action</code> \
--role-arn arn:aws:iam::<code class="replaceable">123456789012</code>:role/<code class="replaceable">MitigationActionValidRole</code> \
--action-params \  
'<span>{</span>
     "addThingsToThingGroupParams": <span>{</span>
         "thingGroupNames": ["<code class="replaceable">ThingGroupForDetectMitigationAction</code>"],
         "overrideDynamicGroups": false
     }
 }'</code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
 "actionArn": "arn:aws:iot:<code class="replaceable">us-east-1</code>:<code class="replaceable">123456789012</code>:mitigationaction/<code class="replaceable">detect_mitigation_action</code>",
 "actionId": "<code class="replaceable">5939e3a0-bf4c-44bb-a547-1ab59ffe67c3</code>"
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/start-detect-mitigation-actions-task.html">start-detect-mitigation-actions-task</a></code> command to
                                             start your mitigation actions task. <code class="code">task-id</code>,
                                             <code class="code">target</code> and <code class="code">actions</code> are required
                                             parameters.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot start-detect-mitigation-actions-task \
    --task-id <code class="replaceable">taskIdForMitigationAction</code> \
    --target '<span>{</span> "violationIds" : [ "<code class="replaceable">violationId-1</code>", "<code class="replaceable">violationId-2</code>" ] }' \
    --actions "<code class="replaceable">detect_mitigation_action</code>" \
    --include-only-active-violations \
    --include-suppressed-alerts</code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "taskId": "<code class="replaceable">taskIdForMitigationAction</code>"
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>(Optional)To view mitigation action executions included in a task, use
                                             the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-detect-mitigation-actions-executions.html">list-detect-mitigation-actions-executions</a></code>
                                             command.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot list-detect-mitigation-actions-executions \
    --task-id <code class="replaceable">taskIdForMitigationAction</code> \
    --max-items <code class="replaceable">5</code> \
    --page-size <code class="replaceable">4</code></code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "actionsExecutions": [
        <span>{</span>
            "taskId": "<code class="replaceable">e56ee95e - f4e7 - 459 c - b60a - 2701784290 af</code>",
            "violationId": "<code class="replaceable">214_fe0d92d21ee8112a6cf1724049d80</code>",
            "actionName": "<code class="replaceable">underTest_MAThingGroup71232127</code>",
            "thingName": "<code class="replaceable">cancelDetectMitigationActionsTaskd143821b</code>",
            "executionStartDate": "<code class="replaceable">Thu Jan 07 18: 35: 21 UTC 2021</code>",
            "executionEndDate": "<code class="replaceable">Thu Jan 07 18: 35: 21 UTC 2021</code>",
            "status": "SUCCESSFUL",
        }
    ]
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>(Optional) Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/describe-detect-mitigation-actions-task.html">describe-detect-mitigation-actions-task</a></code> command to
                                             get information about a mitigation action task.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot describe-detect-mitigation-actions-task \
    --task-id <code class="replaceable">taskIdForMitigationAction</code></code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "taskSummary": <span>{</span>
        "taskId": "<code class="replaceable">taskIdForMitigationAction</code>",
        "taskStatus": "SUCCESSFUL",
        "taskStartTime": 1609988361.224,
        "taskEndTime": 1609988362.281,
        "target": <span>{</span>
            "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
            "behaviorName": "num-messages-sent-ml-behavior"
        },
        "violationEventOccurrenceRange": <span>{</span>
            "startTime": 1609986633.0,
            "endTime": 1609987833.0
        },
        "onlyActiveViolationsIncluded": true,
        "suppressedAlertsIncluded": true,
        "actionsDefinition": [
            <span>{</span>
                "name": "<code class="replaceable">detect_mitigation_action</code>",
                "id": "5939e3a0-bf4c-44bb-a547-1ab59ffe67c3",
                "roleArn": "arn:aws:iam::123456789012:role/<code class="replaceable">MitigatioActionValidRole</code>",
                "actionParams": <span>{</span>
                    "addThingsToThingGroupParams": <span>{</span>
                        "thingGroupNames": [
                            "<code class="replaceable">ThingGroupForDetectMitigationAction</code>"
                        ],
                        "overrideDynamicGroups": false
                    }
                }
            }
        ],
        "taskStatistics": <span>{</span>
            "actionsExecuted": 0,
            "actionsSkipped": 0,
            "actionsFailed": 0
        }
    }
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>(Optional) To get a list of your mitigation actions tasks, use the
                                             <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-detect-mitigation-actions-tasks.html">list-detect-mitigation-actions-tasks</a></code> command.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot list-detect-mitigation-actions-tasks \
    --start-time <code class="replaceable">1609985315</code> \
    --end-time <code class="replaceable">1609988915</code> \
    --max-items <code class="replaceable">5</code> \
    --page-size <code class="replaceable">4</code></code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "tasks": [
        <span>{</span>
            "taskId": "<code class="replaceable">taskIdForMitigationAction</code>",
            "taskStatus": "SUCCESSFUL",
            "taskStartTime": <code class="replaceable">1609988361.224</code>,
            "taskEndTime": <code class="replaceable">1609988362.281</code>,
            "target": <span>{</span>
                "securityProfileName": "<code class="replaceable">security-profile-for-smart-lights</code>",
                "behaviorName": "num-messages-sent-ml-behavior"
            },
            "violationEventOccurrenceRange": <span>{</span>
                "startTime": 1609986633.0,
                "endTime": 1609987833.0
            },
            "onlyActiveViolationsIncluded": true,
            "suppressedAlertsIncluded": true,
            "actionsDefinition": [
                <span>{</span>
                    "name": "detect_mitigation_action",
                    "id": "5939e3a0-bf4c-44bb-a547-1ab59ffe67c3",
                    "roleArn": "arn:aws:iam::123456789012:role/MitigatioActionValidRole",
                    "actionParams": <span>{</span>
                        "addThingsToThingGroupParams": <span>{</span>
                            "thingGroupNames": [
                                "ThingGroupForDetectMitigationAction"
                            ],
                            "overrideDynamicGroups": false
                        }
                    }
                }
            ],
            "taskStatistics": <span>{</span>
                "actionsExecuted": 0,
                "actionsSkipped": 0,
                "actionsFailed": 0
            }
        }
    ]
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>(Optional) To cancel a mitigation actions task, use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/cancel-detect-mitigation-actions-task.html">cancel-detect-mitigation-actions-task</a></code>
                                             command.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot cancel-detect-mitigation-actions-task \
    --task-id <code class="replaceable">taskIdForMitigationAction</code></code></pre>
                                          <p>Output:</p>
                                          
                                          <p>None.</p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                   
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the Amazon Web Services Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="./audit-tutorial.html">Audit guide</div>
                                    <div id="next" class="next-link" accesskey="n" href="./dd-suppressions-example.html">Customize when and how you view AWS IoT Device Defender audit
                                       results
                                    </div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-ml-getting-started.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-ml-getting-started.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS IoT Core';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>
</html>