<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Custom metrics - AWS IoT Core</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="assets" />
      <meta name="target_state" content="dd-detect-custom-metrics" />
      <meta name="default_state" content="dd-detect-custom-metrics" />
      <link rel="icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/iot/latest/developerguide/dd-detect-custom-metrics.html" />
      <meta name="description" content="Learn about using AWS IoT Device Defender custom metrics." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS IoT Core" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="AWS IoT provides secure, bi-directional communication between Internet-connected devices such as sensors, actuators, embedded micro-controllers, or smart appliances and the AWS Cloud. This enables you to collect telemetry data from multiple devices, and store and analyze the data. You can also create applications that enable your users to control these devices from their phones or tablets." />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="IoT Docs" />
      <meta name="this_doc_product" content="AWS IoT Core" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="assets/css/vendor4.css" rel="stylesheet" />
      <link href="assets/css/awsdocs-common.css" rel="stylesheet" /><script type="text/javascript" src="assets/js/vendor3.js" defer=""></script><script type="text/javascript" src="assets/js/vendor4.js" defer=""></script><script type="text/javascript" src="assets/js/vendor1.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-common.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-doc-app.js" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Custom metrics - AWS IoT Core</title>
                        <meta name="pdf" content="iot-dg.pdf#dd-detect-custom-metrics" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07JBRCWWZ" />
                        <meta name="github" content="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/dd-detect-custom-metrics.md" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=210" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT%20Docs&amp;topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-custom-metrics.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-custom-metrics.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-custom-metrics.html" />
                        <meta name="keywords" content="AWS IoT,IoT,Internet of Things" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="iot-dg.pdf#dd-detect-custom-metrics" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a target="_blank" rel="noopener noreferrer" href="https://www.amazon.com/dp/B07JBRCWWZ" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/dd-detect-custom-metrics.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iot/index.html">AWS IoT Core</a><a href="what-is-aws-iot.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#dd-detect-custom-metrics-how-to-console">How to use custom metrics in the console</a><a href="#dd-detect-custom-metrics-how-to-cli">How to use custom metrics from the
                                 CLI</a><a href="#dd-detect-custom-metrics-cli-commands">Custom metrics CLI commands</a><a href="#dd-detect-custom-metrics-apis">Custom metrics APIs</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="dd-detect-custom-metrics">Custom metrics</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>With AWS IoT Device Defender custom metrics, you can define and monitor metrics that
                                    are unique to your
                                    fleet or use case, such as number of devices connected to Wi-Fi gateways, charge levels
                                    for
                                    batteries, or number of power cycles for smart plugs. Custom metric behaviors are
                                    defined in
                                    Security Profiles, which specify expected behaviors for a group of devices (a thing
                                    group)
                                    or for all devices. You can monitor behaviors by setting up alarms, which you can
                                    use to
                                    detect and respond to issues that are specific to the devices.
                                 </p>
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>This chapter contains the following sections:</strong></p>
                                    <ul>
                                       <li><a href="#dd-detect-custom-metrics-how-to-console">How to use custom metrics in the console</a></li>
                                       <li><a href="#dd-detect-custom-metrics-how-to-cli">How to use custom metrics from the
                                             CLI</a></li>
                                       <li><a href="#dd-detect-custom-metrics-cli-commands">Custom metrics CLI commands</a></li>
                                       <li><a href="#dd-detect-custom-metrics-apis">Custom metrics APIs</a></li>
                                    </ul>
                                 </div>
                                 
                                 <h2 id="dd-detect-custom-metrics-how-to-console">How to use custom metrics in the console</h2>
                                 
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Tutorials</strong></p>
                                    <ul>
                                       <li><a href="#dd-detect-custom-metrics-device-agent">AWS IoT Device Defender Agent SDK (Python)</a></li>
                                       <li><a href="#dd-detect-console-create">Create a custom metric and add it to a
                                             Security Profile</a></li>
                                       <li><a href="#dd-detect-console-read">View custom metric details</a></li>
                                       <li><a href="#dd-detect-console-edit">Update a custom metric</a></li>
                                       <li><a href="#dd-detect-console-delete">Delete a custom metric</a></li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h3 id="dd-detect-custom-metrics-device-agent">AWS IoT Device Defender Agent SDK (Python)</h3>
                                 
                                 <p>To get started, download the AWS IoT Device Defender Agent SDK (Python) sample agent.
                                    The agent
                                    gathers the metrics and publishes reports. Once your device-side metrics are
                                    publishing, you can view the metrics being collected and determine thresholds for
                                    setting up alarms. Instructions for setting up the device agent are available on the
                                    <a href="https://github.com/aws-samples/aws-iot-device-defender-agent-sdk-python/blob/master/README.rst" rel="noopener noreferrer" target="_blank"><span>AWS IoT Device Defender Agent SDK (Python) Readme</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. For more information,
                                    see <a href="https://github.com/aws-samples/aws-iot-device-defender-agent-sdk-python" rel="noopener noreferrer" target="_blank"><span>AWS IoT Device Defender Agent SDK (Python)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
                                 </p>
                                  
                                  
                                 
                                 <h3 id="dd-detect-console-create">Create a custom metric and add it to a
                                    Security Profile
                                 </h3>
                                 
                                 <p>The following procedure shows you how to create a custom metric in the
                                    console.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Metrics</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Custom metrics</b> page, choose
                                             <b>Create</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Create custom metric</b> page, do the
                                             following.
                                          </p>
                                          
                                          <div class="orderedlist">
                                              
                                              
                                              
                                              
                                             
                                             <ol>
                                                <li>
                                                   
                                                   <p>Under <b>Name</b>, enter a name for your custom
                                                      metric. You can't modify this name after you create the custom
                                                      metric.
                                                   </p>
                                                   
                                                </li>
                                                <li>
                                                   
                                                   <p>Under <b>Display name (optional)</b>, you can enter
                                                      a friendly name for your custom metric. It doesn't have to be unique
                                                      and it can be modified after creation.
                                                   </p>
                                                   
                                                </li>
                                                <li>
                                                   
                                                   <p>Under <b>Type</b>, choose the type of metric you'd
                                                      like to monitor. Metric types include
                                                      <b>string-list</b>,
                                                      <b>ip-address-list</b>,
                                                      <b>number-list</b>, and
                                                      <b>number</b>. The type can't be modified after
                                                      creation.
                                                   </p>
                                                   
                                                </li>
                                                <li>
                                                   
                                                   <p>Under <b>Tags</b>, you can select tags to be
                                                      associated with the resource.
                                                   </p>
                                                   
                                                </li>
                                             </ol>
                                          </div>
                                          
                                          <p>When you're done, choose <b>Confirm</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>After you've created your custom metric, the <b>Custom
                                                metrics</b> page appears, where you can see your newly created
                                             custom metric.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Next, you need to add your custom metric to a Security Profile. In the
                                             <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>,
                                             in the navigation pane, expand <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Security
                                                profiles</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose the Security Profile you'd like to add your custom metric
                                             to.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Actions</b>, <b>Edit</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Additional Metrics to retain</b>, and then choose
                                             your custom metric. Choose <b>Next</b> on the following
                                             screens until you reach the <b>Confirm</b> page. Choose
                                             <b>Save</b> and <b>Continue</b>. After
                                             your custom metric has been successfully added, the Security Profile details
                                             page appears.
                                          </p>
                                          
                                          <div class="awsdocs-note">
                                             <div class="awsdocs-note-title">
                                                <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                             <div class="awsdocs-note-text">
                                                <p>Percentile statistics are not available for metrics when any of the
                                                   metric values are negative numbers.
                                                </p>
                                             </div>
                                          </div>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="dd-detect-console-read">View custom metric details</h3>
                                 
                                 <p>The following procedure shows you how to view a custom metric's details in the
                                    console.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Metrics</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose the <b>Metric name</b> of the custom metric you'd
                                             like to view the details of.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="dd-detect-console-edit">Update a custom metric</h3>
                                 
                                 <p>The following procedure shows you how to update a custom metric in the
                                    console.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Metrics</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose the option button next to the custom metric you'd like to update.
                                             Then, for <b>Actions</b>, choose
                                             <b>Edit</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Update custom metric</b> page, you can edit the
                                             display name and remove or add tags.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>After you're done, choose <b>Update</b>. The
                                             <b>Custom metrics</b> page.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="dd-detect-console-delete">Delete a custom metric</h3>
                                 
                                 <p>The following procedure shows you how to delete a custom metric in the
                                    console.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>First, remove your custom metric from any Security Profile it's referenced
                                             in. You can view which Security Profiles contain your custom metric on your
                                             custom metric details page. In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the
                                             navigation pane, expand <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Metrics</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose the custom metric you'd like to remove. Remove the custom metric
                                             from any Security Profile listed under <b>Security
                                                Profiles</b> on the custom metric details page.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>In the <a href="https://console.aws.amazon.com/iot" rel="noopener noreferrer" target="_blank"><span>AWS IoT
                                                   console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, in the navigation pane, expand
                                             <b>Defend</b>, and then choose
                                             <b>Detect</b>, <b>Metrics</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose the option button next to the custom metric you'd like to delete.
                                             Then, for <b>Actions</b>, choose
                                             <b>Delete</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>On the <b>Are you sure you want to delete custom metric?</b>
                                             message, choose <b>Delete custom metric</b>.
                                          </p>
                                          
                                          <div class="awsdocs-note awsdocs-warning">
                                             <div class="awsdocs-note-title">
                                                <awsui-icon name="status-warning" variant="error"></awsui-icon><span>Warning</span></div>
                                             <div class="awsdocs-note-text">
                                                <p>After you've deleted a custom metric, you lose all data associated
                                                   with the metric. This action can't be undone.
                                                </p>
                                             </div>
                                          </div>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                  
                                  
                                 
                                 <h2 id="dd-detect-custom-metrics-how-to-cli">How to use custom metrics from the
                                    CLI
                                 </h2>
                                 
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Tutorials</strong></p>
                                    <ul>
                                       <li><a href="#dd-detec-custom-metrics-cli-sdk">AWS IoT Device Defender Agent SDK (Python)</a></li>
                                       <li><a href="#dd-detect-custom-cli-create">Create a custom metric and add it to a
                                             Security Profile</a></li>
                                       <li><a href="#dd-detect-custom-cli-read">View custom metric details</a></li>
                                       <li><a href="#dd-detect-custom-cli-edit">Update a custom metric</a></li>
                                       <li><a href="#dd-detect-custom-cli-delete">Delete a custom metric</a></li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h3 id="dd-detec-custom-metrics-cli-sdk">AWS IoT Device Defender Agent SDK (Python)</h3>
                                 
                                 <p>To get started, download the AWS IoT Device Defender Agent SDK (Python) sample agent.
                                    The agent
                                    gathers the metrics and publishes reports. After your device-side metrics are
                                    publishing, you can view the metrics being collected and determine thresholds for
                                    setting up alarms. Instructions for setting up the device agent are available on the
                                    <a href="https://github.com/aws-samples/aws-iot-device-defender-agent-sdk-python/blob/master/README.rst" rel="noopener noreferrer" target="_blank"><span>AWS IoT Device Defender Agent SDK (Python) Readme</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. For more information,
                                    see <a href="https://github.com/aws-samples/aws-iot-device-defender-agent-sdk-python" rel="noopener noreferrer" target="_blank"><span>AWS IoT Device Defender Agent SDK (Python)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
                                 </p>
                                  
                                  
                                 
                                 <h3 id="dd-detect-custom-cli-create">Create a custom metric and add it to a
                                    Security Profile
                                 </h3>
                                 
                                 <p>The following procedure shows you how to create a custom metric and add it to a
                                    Security Profile from the CLI.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/create-custom-metric.html">create-custom-metric</a></code> command to create your custom
                                             metric. The following example creates a custom metric that measures battery
                                             percentage.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot create-custom-metric \
    --metric-name "<code class="replaceable">batteryPercentage</code>" \
    --metric-type "<code class="replaceable">number</code>" \
    --display-name "<code class="replaceable">Remaining battery percentage.</code>" \
    --region <code class="replaceable">us-east-1</code>
    --client-request-token "<code class="replaceable">02ccb92b-33e8-4dfa-a0c1-35b181ed26b0</code>" \</code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "metricName": "<code class="replaceable">batteryPercentage</code>",
    "metricArn": "arn:aws:iot:<code class="replaceable">us-east-1</code>:<code class="replaceable">1234564789012</code>:custommetric/<code class="replaceable">batteryPercentage</code>"
}
</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>After you've created your custom metric, you can either add the custom
                                             metric to an existing profile using <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/update-security-profile.html">update-security-profile</a></code> or create a new security
                                             profile to add the custom metric to using <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/create-security-profile.html">create-security-profile</a></code>. Here, we create a new
                                             security profile called <code class="replaceable">batteryUsage</code> to add our
                                             new <code class="replaceable">batteryPercentage</code> custom metric to. We also
                                             add a Rules Detect metric called
                                             <code class="replaceable">cellularBandwidth</code>.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot create-security-profile \
    --security-profile-name <code class="replaceable">batteryUsage</code> \
    --security-profile-description "<code class="replaceable">Shows how much battery is left in percentile.</code>"  \
    --behaviors "[<span>{</span>\"name\":\"great-than-75\",\"metric\":\"<code class="replaceable">batteryPercentage</code>\",\"criteria\":<span>{</span>\"comparisonOperator\":\"greater-than\",\"value\":<span>{</span>\"number\":75},\"consecutiveDatapointsToAlarm\":5,\"consecutiveDatapointsToClear\":1}},<span>{</span>\"name\":\"<code class="replaceable">cellularBandwidth</code>\",\"metric\":\"aws:message-byte-size\",\"criteria\":<span>{</span>\"comparisonOperator\":\"less-than\",\"value\":<span>{</span>\"count\":128},\"consecutiveDatapointsToAlarm\":1,\"consecutiveDatapointsToClear\":1}}]" \
    --region <code class="replaceable">us-east-1</code></code></pre>
                                          <p>Output:</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "securityProfileArn": "<code class="replaceable">arn:aws:iot:us-east-1:1234564789012:securityprofile/batteryUsage</code>",
    "securityProfileName": "<code class="replaceable">batteryUsage</code>"
}</code></pre>
                                          </li>
                                    </ol>
                                 </div>
                                 
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>Percentile statistics are not available for metrics when any of the metric
                                          values are negative numbers.
                                       </p>
                                    </div>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="dd-detect-custom-cli-read">View custom metric details</h3>
                                 
                                 <p>The following procedure shows you how to view the details for a custom metric from
                                    the CLI.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ul>
                                       <li>
                                          
                                          <p>Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-custom-metrics.html">list-custom-metrics</a></code> command to view all of your
                                             custom metrics.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot list-custom-metrics \
    --region <code class="replaceable">us-east-1</code></code></pre>
                                          <p>The output of this command looks like the following.</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "metricNames": [
        "<code class="replaceable">batteryPercentage</code>"
    ]
}
</code></pre>
                                          </li>
                                    </ul>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="dd-detect-custom-cli-edit">Update a custom metric</h3>
                                 
                                 <p>The following procedure shows you how to update a custom metric from the
                                    CLI.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ul>
                                       <li>
                                          
                                          <p>Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/update-custom-metric.html">update-custom-metric</a></code> command to update a custom
                                             metric. The following example updates the <code class="code">display-name</code>.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot update-custom-metric \
    --metric-name <code class="replaceable">batteryPercentage</code> \
    --display-name '<code class="replaceable">remaining battery percentage on device</code>' \
    --region <code class="replaceable">us-east-1</code></code></pre>
                                          <p>The output of this command looks like the following.</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "metricName": "<code class="replaceable">batteryPercentage</code>",
    "metricArn": "arn:aws:iot:<code class="replaceable">us-east-1</code>:<code class="replaceable">1234564789012</code>:custommetric/<code class="replaceable">batteryPercentage</code>",
    "metricType": "number",
    "displayName": "<code class="replaceable">remaining battery percentage on device</code>",
    "creationDate": "2020-11-17T23:01:35.110000-08:00",
    "lastModifiedDate": "2020-11-17T23:02:12.879000-08:00"
}
</code></pre>
                                          </li>
                                    </ul>
                                 </div>
                                  
                                  
                                 
                                 <h3 id="dd-detect-custom-cli-delete">Delete a custom metric</h3>
                                 
                                 <p>The following procedure shows you how to delete a custom metric from the
                                    CLI.
                                 </p>
                                 
                                 <div class="procedure">
                                    <ol>
                                       <li>
                                          
                                          <p>To delete a custom metric, first remove it from any Security Profiles that
                                             it's attached to. Use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-security-profiles.html">list-security-profiles</a></code> command to view Security
                                             Profiles with a certain custom metric.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>To remove a custom metric from a Security Profile, use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/update-security-profiles.html">update-security-profiles</a></code> command. Enter all
                                             information that you want to keep, but exclude the custom metric.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot update-security-profile \
  --security-profile-name <code class="replaceable">batteryUsage</code> \
  --behaviors "[<span>{</span>\"name\":\"<code class="replaceable">cellularBandwidth</code>\",\"metric\":\"aws:message-byte-size\",\"criteria\":<span>{</span>\"comparisonOperator\":\"less-than\",\"value\":<span>{</span>\"count\":128},\"consecutiveDatapointsToAlarm\":1,\"consecutiveDatapointsToClear\":1}}]"</code></pre>
                                          <p>The output of this command looks like the following.</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
  "behaviors": [<span>{</span>\"name\":\"<code class="replaceable">cellularBandwidth</code>\",\"metric\":\"aws:message-byte-size\",\"criteria\":<span>{</span>\"comparisonOperator\":\"less-than\",\"value\":<span>{</span>\"count\":128},\"consecutiveDatapointsToAlarm\":1,\"consecutiveDatapointsToClear\":1}}],
  "securityProfileName": "<code class="replaceable">batteryUsage</code>",
  "lastModifiedDate": 2020-11-17T23:02:12.879000-09:00,
  "securityProfileDescription": "<code class="replaceable">Shows how much battery is left in percentile.</code>",
  "version": 2,
  "securityProfileArn": "<code class="replaceable">arn:aws:iot:us-east-1:1234564789012:securityprofile/batteryUsage</code>",  
  "creationDate": 2020-11-17T23:02:12.879000-09:00
}</code></pre>
                                          </li>
                                       <li>
                                          
                                          <p>After the custom metric is detached, use the <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/delete-custom-metric.html">delete-custom-metric</a></code> command to delete the custom
                                             metric.
                                          </p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iot delete-custom-metric  \
  --metric-name <code class="replaceable">batteryPercentage</code> \
  --region <code class="replaceable">us-east-1</code></code></pre>
                                          <p>The output of this command looks like the following</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">HTTP 200</code></pre>
                                          </li>
                                    </ol>
                                 </div>
                                  
                                 
                                  
                                 
                                 <h2 id="dd-detect-custom-metrics-cli-commands">Custom metrics CLI commands</h2>
                                 
                                 <p>You can use the following CLI commands to create and manage custom metrics.</p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/create-custom-metric.html">create-custom-metric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/describe-custom-metric.html">describe-custom-metric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-custom-metrics.html">list-custom-metrics</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/update-custom-metric.html">update-custom-metric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/delete-custom-metric.html">delete-custom-metric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-security-profiles.html">list-security-profiles</a></p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h2 id="dd-detect-custom-metrics-apis">Custom metrics APIs</h2>
                                 
                                 <p>The following APIs can be used to create and manage custom metrics.</p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/iot/latest/apireference/API_CreateCustomMetric.html">CreateCustomMetric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/iot/latest/apireference/API_DescribeCustomMetric.html">DescribeCustomMetric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/iot/latest/apireference/API_ListCustomMetrics.html">ListCustomMetrics</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/iot/latest/apireference/API_UpdateCustomMetric.html">UpdateCustomMetric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/iot/latest/apireference/API_DeleteCustomMetric.html">DeleteCustomMetric</a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://docs.aws.amazon.com/iot/latest/apireference/API_ListSecurityProfiles.html">ListSecurityProfiles</a></p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the Amazon Web Services Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="./dd-detect-ml.html">ML Detect</div>
                                    <div id="next" class="next-link" accesskey="n" href="./detect-device-side-metrics.html">Device-side metrics</div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-custom-metrics.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/dd-detect-custom-metrics.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS IoT Core';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>
</html>