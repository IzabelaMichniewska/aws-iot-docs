<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Apache Kafka - AWS IoT Core</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="assets" />
      <meta name="target_state" content="apache-kafka-rule-action" />
      <meta name="default_state" content="apache-kafka-rule-action" />
      <link rel="icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/iot/latest/developerguide/apache-kafka-rule-action.html" />
      <meta name="description" content="Use the Apache Kafka rule action to send messages from your devices directly to your Amazon Managed Streaming for Apache Kafka (Amazon MSK) or self-managed Apache Kafka clusters for data analysis and visualization." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS IoT Core" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="AWS IoT provides secure, bi-directional communication between Internet-connected devices such as sensors, actuators, embedded micro-controllers, or smart appliances and the AWS Cloud. This enables you to collect telemetry data from multiple devices, and store and analyze the data. You can also create applications that enable your users to control these devices from their phones or tablets." />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="IoT Docs" />
      <meta name="this_doc_product" content="AWS IoT Core" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="assets/css/vendor4.css" rel="stylesheet" />
      <link href="assets/css/awsdocs-common.css" rel="stylesheet" /><script type="text/javascript" src="assets/js/vendor3.js" defer=""></script><script type="text/javascript" src="assets/js/vendor4.js" defer=""></script><script type="text/javascript" src="assets/js/vendor1.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-common.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-doc-app.js" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Apache Kafka - AWS IoT Core</title>
                        <meta name="pdf" content="iot-dg.pdf#apache-kafka-rule-action" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07JBRCWWZ" />
                        <meta name="github" content="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/apache-kafka-rule-action.md" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=210" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT%20Docs&amp;topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/apache-kafka-rule-action.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/apache-kafka-rule-action.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/apache-kafka-rule-action.html" />
                        <meta name="keywords" content="AWS IoT,IoT,Internet of Things" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="iot-dg.pdf#apache-kafka-rule-action" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a target="_blank" rel="noopener noreferrer" href="https://www.amazon.com/dp/B07JBRCWWZ" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/apache-kafka-rule-action.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iot/index.html">AWS IoT Core</a><a href="what-is-aws-iot.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#apache-kafka-rule-action-requirements">Requirements</a><a href="#apache-kafka-rule-action-parameters">Parameters</a><a href="#apache-kafka-rule-action-examples">Examples</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="apache-kafka-rule-action">Apache Kafka</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>The Apache Kafka (Kafka) action sends messages directly to your Amazon Managed Streaming
                                    for Apache Kafka (Amazon MSK) or self-managed 
                                    Apache Kafka clusters for data analysis and visualization.
                                 </p>
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>This topic assumes familiarity with the Apache Kafka platform and related concepts.
                                          For more
                                          information about Apache Kafka, see <a href="https://kafka.apache.org/" rel="noopener noreferrer" target="_blank"><span>Apache Kafka</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
                                       </p>
                                    </div>
                                 </div>
                                 
                                 <h2 id="apache-kafka-rule-action-requirements">Requirements</h2>
                                 
                                 
                                 <p>This rule action has the following requirements:</p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>An IAM role that AWS IoT can assume to perform the <code class="code">ec2:CreateNetworkInterface</code>,
                                             <code class="code">ec2:DescribeNetworkInterfaces</code>,
                                             <code class="code">ec2:CreateNetworkInterfacePermission</code>,
                                             <code class="code">ec2:DeleteNetworkInterface</code>,
                                             <code class="code">ec2:DescribeSubnets</code>, <code class="code">ec2:DescribeVpcs</code>, and
                                             <code class="code">ec2:DescribeVpcAttribute</code> operations. This role creates
                                             and manages elastic network interfaces to your Amazon Virtual Private Cloud to reach
                                             your
                                             Kafka broker. For more information, see <a href="./iot-create-role.html">Granting AWS IoT the required access</a>.
                                          </p>
                                          
                                          <p>In the AWS IoT console, you can choose or create a role to allow AWS IoT Core to perform
                                             this rule action. 
                                          </p>
                                          
                                          <p>For more information about network interfaces, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html">Elastic network
                                                interfaces</a> in the Amazon EC2 User Guide.
                                          </p>
                                          
                                          <p>The policy attached to the role you specify should look like the following example.</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
    <span>{</span>
        "Effect": "Allow",
        "Action": [
            "ec2:CreateNetworkInterface",
            "ec2:DescribeNetworkInterfaces",
            "ec2:CreateNetworkInterfacePermission",
            "ec2:DeleteNetworkInterface",
            "ec2:DescribeSubnets",
            "ec2:DescribeVpcs",
            "ec2:DescribeVpcAttribute"
            ],
            "Resource": "*"
        }
    ]
}
                        </code></pre>
                                          </li>
                                       <li class="listitem">
                                          <p>If you use AWS Secrets Manager to store the credentials required to connect to your
                                             Kafka broker, you must create  
                                             an IAM role that AWS IoT Core can assume to perform the <code class="code">secretsmanager:GetSecretValue</code> and 
                                             <code class="code">secretsmanager:DescribeSecret</code> operations.
                                          </p>
                                          
                                          <p>The policy attached to the role you specify should look like the following example.</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
    <span>{</span>
        "Effect": "Allow",
        "Action": [
            "secretsmanager:GetSecretValue",
            "secretsmanager:DescribeSecret"
            ],
            "Resource": [
                "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">123456789012</code>:secret:kafka_client_truststore-*",
                "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">123456789012</code>:secret:kafka_keytab-*"
            ]
        }
    ]
}
                        </code></pre>
                                          </li>
                                       <li class="listitem">
                                          <p>You must create a virtual private cloud (VPC) destination. (You can run your Apache
                                             Kafka
                                             clusters inside Amazon Virtual Private Cloud.) The AWS IoT rules engine creates a
                                             network
                                             interface in each of the subnets listed in the VPC destination. This
                                             allows the rules engine to route traffic directly to the VPC. When you
                                             create a VPC destination, the AWS IoT rules engine automatically creates a
                                             VPC rule action. For more information about VPC rule actions, see <a href="./vpc-rule-action.html">VPC</a>.
                                          </p>
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>If you use a customer-managed AWS Key Management Service (AWS KMS) customer master
                                             key
                                             (CMK) to encrypt data at rest, the service must have permission to use
                                             the CMK on the caller's behalf. For more information, see <a href="https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html">Amazon MSK encryption</a> in
                                             the <em>Amazon Managed Streaming for Apache Kafka Developer Guide</em>.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h2 id="apache-kafka-rule-action-parameters">Parameters</h2>
                                 
                                 <p>When you create an AWS IoT rule with this action, you must specify the following information:</p>
                                 
                                 <div class="variablelist">
                                     
                                     
                                     
                                     
                                     
                                    
                                    <dl>
                                       
                                       <dt><span class="term">destinationArn</span></dt>
                                       
                                       <dd>
                                          <p>The Amazon Resource Name (ARN) of the VPC destination. For information about creating
                                             a VPC
                                             destination, see <a href="./vpc-rule-action.html">VPC</a>.
                                          </p>
                                       </dd>
                                        
                                       
                                       <dt><span class="term">topic</span></dt>
                                       
                                       <dd>
                                          <p>The Kafka topic for messages to be sent to the Kafka broker.</p>
                                          
                                          <p>You can substitute this field using a substitution template. For more information,
                                             see 
                                             <a href="./iot-substitution-templates.html">Substitution templates</a>.
                                             
                                          </p>
                                          
                                       </dd>
                                        
                                       
                                       <dt><span class="term">key (optional)</span></dt>
                                       
                                       <dd>
                                          <p>The Kafka message key.</p>
                                          
                                          <p>You can substitute this field using a substitution template. For more information,
                                             see 
                                             <a href="./iot-substitution-templates.html">Substitution templates</a>.
                                             
                                          </p>
                                          
                                       </dd>
                                        
                                       
                                       <dt><span class="term">partition (optional)</span></dt>
                                       
                                       <dd>
                                          <p>The Kafka message partition.</p>
                                          
                                          <p>You can substitute this field using a substitution template. For more information,
                                             see
                                             <a href="./iot-substitution-templates.html">Substitution templates</a>.
                                             
                                          </p>
                                          
                                       </dd>
                                        
                                       
                                       <dt><span class="term">clientProperties</span></dt>
                                       
                                       <dd>
                                          <p>An object that defines the properties of the Apache Kafka producer client.</p>
                                          
                                          <div class="variablelist">
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                              
                                             
                                             <dl>
                                                
                                                <dt><span class="term">acks (optional)</span></dt>
                                                
                                                <dd>
                                                   <p>The number of acknowledgments the producer requires the server to have received before
                                                      considering a request complete.
                                                   </p>
                                                   
                                                   <p>If you specify 0 as the value, the producer will not wait for any acknowledgment from
                                                      the server. 
                                                      If the server doesn't receive the message, the producer won't retry to send the message.
                                                   </p>
                                                   
                                                   <p>Valid values: 0, 1. The default value is 1.</p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">bootstrap.servers</span></dt>
                                                
                                                <dd>
                                                   <p>A list of host and port pairs (<code class="code">host1:port1</code>, <code class="code">host2:port2</code>, etc.) used to establish the initial connection to your Kafka cluster.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">compression.type (optional)</span></dt>
                                                
                                                <dd>
                                                   <p>The compression type for all data generated by the producer.</p>
                                                   
                                                   <p>Valid values: <code class="code">none</code>, <code class="code">gzip</code>, <code class="code">snappy</code>, <code class="code">lz4</code>, <code class="code">zstd</code>. 
                                                      The default value is <code class="code">none</code>.
                                                   </p>
                                                   
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">security.protocol</span></dt>
                                                
                                                <dd>
                                                   <p>The security protocol used to attach to your Kafka broker.</p>
                                                   
                                                   <p>Valid values: <code class="code">SSL</code>, <code class="code">SASL_SSL</code>. The default value is <code class="code">SSL</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">key.serializer</span></dt>
                                                
                                                <dd>
                                                   <p>Specifies how to turn the key objects you provide with the<code class="code">ProducerRecord</code> into
                                                      bytes.
                                                   </p>
                                                   
                                                   <p>Valid value: <code class="code">StringSerializer</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">value.serializer</span></dt>
                                                
                                                <dd>
                                                   <p>Specifies how to turn value objects you provide with the <code class="code">ProducerRecord</code> into
                                                      bytes.
                                                   </p>
                                                   
                                                   <p>Valid value: <code class="code">ByteBufferSerializer</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">ssl.truststore</span></dt>
                                                
                                                <dd>
                                                   <p>The truststore file in base64 format or the location of the truststore file in <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/">AWS Secrets Manager</a>. This value
                                                      isn't required if your truststore is trusted by Amazon
                                                      certificate authoriies (CA).
                                                   </p>
                                                   
                                                   <p>This field supports substitution templates. If you use Secrets Manager to store the
                                                      credentials required to connect to your Kafka broker, you can 
                                                      use the get_secret SQL function to retrieve the value for this field. For more information
                                                      about substitution templates, see 
                                                      <a href="./iot-substitution-templates.html">Substitution templates</a>. For more information about the get_secret SQL function, 
                                                      see <a href="./iot-sql-functions.html#iot-sql-function-get-secret">get_secret(secretId, secretType, key, roleArn)
                                                         </a>. If the truststore is in the form of a file, use the <code class="code">SecretBinary</code> parameter. 
                                                      If the truststore is in the form of a string, use the <code class="code">SecretString</code> parameter.
                                                   </p>
                                                   
                                                   <p>The maximum size of this value is 65 KB.</p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">ssl.truststore.password</span></dt>
                                                
                                                <dd>
                                                   <p>The password for the truststore. This value is required only if you've created a password
                                                      for the truststore.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">ssl.keystore</span></dt>
                                                
                                                <dd>
                                                   <p>The keystore file. This value is required when you specify <code class="code">SSL</code> as the value for <code class="code">security.protocol</code>.
                                                   </p>
                                                   
                                                   <p>This field supports substitution templates. You must use Secrets Manager to store
                                                      the credentials required to connect to your Kafka broker. 
                                                      Use the get_secret SQL function to retrieve the value for this field. For more information
                                                      about substitution templates, see 
                                                      <a href="./iot-substitution-templates.html">Substitution templates</a>. For more information about the get_secret SQL function, 
                                                      see <a href="./iot-sql-functions.html#iot-sql-function-get-secret">get_secret(secretId, secretType, key, roleArn)
                                                         </a>. Use the <code class="code">SecretBinary</code> parameter.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">ssl.keystore.password</span></dt>
                                                
                                                <dd>
                                                   <p>The store password for the keystore file. This value is required if you specify a
                                                      value for <code class="code">ssl.keystore</code>.
                                                   </p>
                                                   
                                                   <p>The value of this field can be plain text. This field also
                                                      supports substitution templates. You must use Secrets Manager
                                                      to store the credentials required to connect to your
                                                      Kafka broker. Use the get_secret SQL function to
                                                      retrieve the value for this field. For more information
                                                      about substitution templates, see <a href="./iot-substitution-templates.html">Substitution templates</a>. For more
                                                      information about the get_secret SQL function, see <a href="./iot-sql-functions.html#iot-sql-function-get-secret">get_secret(secretId, secretType, key, roleArn)
                                                         </a>.Use
                                                      the <code class="code">SecretString</code> parameter.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">ssl.key.password</span></dt>
                                                
                                                <dd>
                                                   <p>The password of the private key in your keystore file.</p>
                                                   
                                                   <p>This field supports substitution templates. You must use Secrets Manager to store
                                                      the credentials required to connect to your Kafka broker. 
                                                      Use the get_secret SQL function to retrieve the value for this field. For more information
                                                      about substitution templates, see 
                                                      <a href="./iot-substitution-templates.html">Substitution templates</a>. For more information about the get_secret SQL function, 
                                                      see <a href="./iot-sql-functions.html#iot-sql-function-get-secret">get_secret(secretId, secretType, key, roleArn)
                                                         </a>. Use the <code class="code">SecretString</code> parameter.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.mechanism</span></dt>
                                                
                                                <dd>
                                                   <p>The security mechanism used to connect to your Kafka broker. This value is required
                                                      when you specify <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code>.
                                                   </p>
                                                   
                                                   <p>Valid values: <code class="code">PLAIN</code>, <code class="code">SCRAM-SHA-512</code>, <code class="code">GSSAPI</code>.
                                                   </p>
                                                   
                                                   <div class="awsdocs-note">
                                                      <div class="awsdocs-note-title">
                                                         <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                                      <div class="awsdocs-note-text">
                                                         <p><code class="code">SCRAM-SHA-512</code> is the only supported security mechanism in 
                                                            the cn-north-1, cn-northwest-1, us-gov-east-1, and us-gov-west-1 Regions.
                                                         </p>
                                                      </div>
                                                   </div>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.plain.username</span></dt>
                                                
                                                <dd>
                                                   <p>The user name used to retrieve the secret string from Secrets Manager. This value
                                                      is required when you specify 
                                                      <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> and <code class="code">PLAIN</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.plain.password</span></dt>
                                                
                                                <dd>
                                                   <p>The password used to retrieve the secret string from Secrets Manager. This value is
                                                      required when you specify  
                                                      <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> and <code class="code">PLAIN</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.scram.username</span></dt>
                                                
                                                <dd>
                                                   <p>The user name used to retrieve the secret string from Secrets Manager. This value
                                                      is required when you specify 
                                                      <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> and <code class="code">SCRAM-SHA-512</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.scram.password</span></dt>
                                                
                                                <dd>
                                                   <p>The password used to retrieve the secret string from Secrets Manager. This value is
                                                      required when you specify  
                                                      <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> and <code class="code">SCRAM-SHA-512</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.kerberos.keytab</span></dt>
                                                
                                                <dd>
                                                   <p>The keytab file for Kerberos authentication in Secrets Manager. This value is required
                                                      when you specify <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> 
                                                      and <code class="code">GSSAPI</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                   
                                                   <p>This field supports substitution templates. You must use
                                                      Secrets Manager to store the credentials required to connect
                                                      to your Kafka broker. Use the get_secret SQL function to
                                                      retrieve the value for this field. For more information
                                                      about substitution templates, see <a href="./iot-substitution-templates.html">Substitution templates</a>. For more
                                                      information about the get_secret SQL function, see <a href="./iot-sql-functions.html#iot-sql-function-get-secret">get_secret(secretId, secretType, key, roleArn)
                                                         </a>.Use
                                                      the <code class="code">SecretBinary</code> parameter.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.kerberos.service.name</span></dt>
                                                
                                                <dd>
                                                   <p>The Kerberos principal name under which Apache Kafka runs. This value is required
                                                      when you specify <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> 
                                                      and <code class="code">GSSAPI</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.kerberos.krb5.kdc</span></dt>
                                                
                                                <dd>
                                                   <p>The hostname of the key distribution center (KDC) to which your Apache Kafka producer
                                                      client
                                                      connects. This value is required when you specify
                                                      <code class="code">SASL_SSL</code> for
                                                      <code class="code">security.protocol</code> and
                                                      <code class="code">GSSAPI</code> for
                                                      <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.kerberos.krb5.realm</span></dt>
                                                
                                                <dd>
                                                   <p>The realm to which your Apache Kafka producer client connects. This value is required
                                                      when you specify <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> 
                                                      and <code class="code">GSSAPI</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                 
                                                
                                                <dt><span class="term">sasl.kerberos.principal</span></dt>
                                                
                                                <dd>
                                                   <p>The unique Kerberos identity to which Kerberos can assign tickets to access Kerberos-aware
                                                      services. This value is required when you specify <code class="code">SASL_SSL</code> for <code class="code">security.protocol</code> 
                                                      and <code class="code">GSSAPI</code> for <code class="code">sasl.mechanism</code>.
                                                   </p>
                                                </dd>
                                                
                                             </dl>
                                          </div>
                                          
                                       </dd>
                                       
                                    </dl>
                                 </div>
                                  
                                 
                                 <h2 id="apache-kafka-rule-action-examples">Examples</h2>
                                 
                                 <p>The following JSON example defines an Apache Kafka action in an AWS IoT
                                    rule.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
"topicRulePayload": <span>{</span>
    "sql": "SELECT * FROM 'some/topic'", 
    "ruleDisabled": false, 
    "awsIotSqlVersion": "2016-03-23",
    "actions": [
    <span>{</span>
        "kafka": <span>{</span>
            "destinationArn": "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">123456789012</code>:ruledestination/vpc/<code class="replaceable">VPCDestinationARN</code>",
            "topic": "<code class="replaceable">TopicName</code>",
            "clientProperties": <span>{</span>
                "bootstrap.servers": "<code class="replaceable">kafka.com:9092</code>",
                "security.protocol": "SASL_SSL",
                "ssl.truststore": "$<span>{</span>get_secret('kafka_client_truststore', 'SecretBinary',
'arn:aws:iam::<code class="replaceable">123456789012</code>:role/<code class="replaceable">kafka-get-secret-role-name</code>')}",
                "ssl.truststore.password": "<code class="replaceable">kafka password</code>",
               "sasl.mechanism": "GSSAPI",
               "sasl.kerberos.service.name": "kafka",
               "sasl.kerberos.krb5.kdc": "<code class="replaceable">kerberosdns.com</code>",
               "sasl.kerberos.keytab": "$<span>{</span>get_secret('kafka_keytab',
               'SecretBinary', 'arn:aws:iam::<code class="replaceable">123456789012</code>:role/<code class="replaceable">kafka-get-secret-role-name</code>')}",
               "sasl.kerberos.krb5.realm": "<code class="replaceable">KERBEROSREALM</code>",
               "sasl.kerberos.principal": "<code class="replaceable">kafka-keytab/kafka-keytab.com</code>"         
            }
        }
    }
]

}
                </code></pre>
                                 <p><b>Important notes about your Kerberos
                                       setup</b></p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          <p>Your key distribution center (KDC) must be resolvable through private Domain Name
                                             System (DNS)
                                             within your target VPC. One possible approach is to add the KDC DNS
                                             entry to a private hosted zone. For more information about this
                                             approach, see <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zones-private.html">Working with private hosted zones</a>.
                                          </p>
                                       </li>
                                       <li class="listitem">
                                          <p>Each VPC must have DNS resolution enabled. For more information, see <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html">Using DNS with your VPC</a>.
                                          </p>
                                       </li>
                                       <li class="listitem">
                                          <p>Network interface security groups and instance-level security groups in the VPC destination
                                             must allow traffic from within your VPC on the following ports.
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   <p>TCP traffic on the bootstrap broker listener port (often 9092, but must be within
                                                      the 9000 -
                                                      9100 range)
                                                   </p>
                                                </li>
                                                <li class="listitem">
                                                   <p>TCP and UDP traffic on port 88 for the KDC</p>
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </li>
                                       <li class="listitem">
                                          <p><code class="code">SCRAM-SHA-512</code> is the only supported security mechanism in 
                                             the cn-north-1, cn-northwest-1, us-gov-east-1, and us-gov-west-1 Regions.
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the Amazon Web Services Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="./iot-rule-actions.html">AWS IoT rule actions</div>
                                    <div id="next" class="next-link" accesskey="n" href="./cloudwatch-alarms-rule-action.html">CloudWatch alarms</div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/apache-kafka-rule-action.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/apache-kafka-rule-action.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS IoT Core';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>
</html>