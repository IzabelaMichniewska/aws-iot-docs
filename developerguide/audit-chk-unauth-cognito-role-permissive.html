<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Unauthenticated Cognito role overly permissive - AWS IoT Core</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="assets" />
      <meta name="target_state" content="audit-chk-unauth-cognito-role-permissive" />
      <meta name="default_state" content="audit-chk-unauth-cognito-role-permissive" />
      <link rel="icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/iot/latest/developerguide/audit-chk-unauth-cognito-role-permissive.html" />
      <meta name="description" content="Use this check for overly permissive Amazon Cognito roles for AWS IoT Device Defender." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS IoT Core" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="AWS IoT provides secure, bi-directional communication between Internet-connected devices such as sensors, actuators, embedded micro-controllers, or smart appliances and the AWS Cloud. This enables you to collect telemetry data from multiple devices, and store and analyze the data. You can also create applications that enable your users to control these devices from their phones or tablets." />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="IoT Docs" />
      <meta name="this_doc_product" content="AWS IoT Core" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="assets/css/vendor4.css" rel="stylesheet" />
      <link href="assets/css/awsdocs-common.css" rel="stylesheet" /><script type="text/javascript" src="assets/js/vendor3.js" defer=""></script><script type="text/javascript" src="assets/js/vendor4.js" defer=""></script><script type="text/javascript" src="assets/js/vendor1.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-common.js" defer=""></script><script type="text/javascript" src="assets/js/awsdocs-doc-app.js" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Unauthenticated Cognito role overly permissive - AWS IoT Core</title>
                        <meta name="pdf" content="iot-dg.pdf#audit-chk-unauth-cognito-role-permissive" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07JBRCWWZ" />
                        <meta name="github" content="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/audit-chk-unauth-cognito-role-permissive.md" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=210" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT%20Docs&amp;topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/audit-chk-unauth-cognito-role-permissive.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/audit-chk-unauth-cognito-role-permissive.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/iot/latest/developerguide/audit-chk-unauth-cognito-role-permissive.html" />
                        <meta name="keywords" content="AWS IoT,IoT,Internet of Things" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="iot-dg.pdf#audit-chk-unauth-cognito-role-permissive" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a target="_blank" rel="noopener noreferrer" href="https://www.amazon.com/dp/B07JBRCWWZ" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-iot-docs/tree/master/developerguide/audit-chk-unauth-cognito-role-permissive.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iot/index.html">AWS IoT Core</a><a href="what-is-aws-iot.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#audit-chk-unauth-cognito-role-permissive-details">Details</a><a href="#audit-chk-unauth-cognito-role-permissive-why-it-matters">Why it matters</a><a href="#audit-chk-unauth-cognito-role-permissive-how-to-fix">How to fix
                                 it</a><a href="#manage-modify-things-check">Manage or modify things</a><a href="#read-thing-admin-data-check">Read thing administrative data</a><a href="#manage-non-things-check">Manage non-things</a><a href="#audit-chk-unauth-cognito-role-permissive-mqtt-topics">Subscribe/publish to MQTT topics</a><a href="#read-modify-shadow-job-data-check">Read/modify shadow or job
                                 data</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="audit-chk-unauth-cognito-role-permissive">Unauthenticated Cognito role
                                    overly permissive
                                 </h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>A policy attached to an unauthenticated Amazon Cognito identity pool role is considered
                                    too
                                    permissive because it grants permission to perform any of the following AWS IoT
                                    actions:
                                 </p>
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>Manage or modify things.</p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>Read thing administrative data.</p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>Manage non-thing related data or resources.</p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 <p>Or, because it grants permission to perform the following AWS IoT actions on a broad
                                    set
                                    of devices:
                                 </p>
                                 <div class="itemizedlist">
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>Use MQTT to connect, publish, or subscribe to reserved topics (including
                                             shadow or job execution data).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>Use API commands to read or modify shadow or job execution data.</p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 <p>In general, devices that connect using an unauthenticated Amazon Cognito identity
                                    pool role
                                    should have only limited permission to publish and subscribe to thing-specific MQTT
                                    topics or use the API commands to read and modify thing-specific data related to shadow
                                    or job execution data.
                                 </p>
                                 <p>This check appears as
                                    <code class="code">UNAUTHENTICATED_COGNITO_ROLE_OVERLY_PERMISSIVE_CHECK</code> in the CLI and
                                    API.
                                 </p>
                                 <p>Severity: <b>Critical</b></p>
                                 
                                 <h2 id="audit-chk-unauth-cognito-role-permissive-details">Details</h2>
                                 
                                 <p>For this check, AWS IoT Device Defender audits all Amazon Cognito identity pools that
                                    have been used to
                                    connect to the AWS IoT message broker during the 31 days before the audit execution.
                                    All Amazon Cognito identity pools from which either an authenticated or unauthenticated
                                    Amazon Cognito
                                    identity connected are included in the audit.
                                 </p>
                                 
                                 <p>The following reason codes are returned when this check finds a noncompliant
                                    unauthenticated Amazon Cognito identity pool role:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>ALLOWS_ACCESS_TO_IOT_ADMIN_ACTIONS</p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>ALLOWS_BROAD_ACCESS_TO_IOT_DATA_PLANE_ACTIONS</p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                  
                                 
                                 <h2 id="audit-chk-unauth-cognito-role-permissive-why-it-matters">Why it matters</h2>
                                 
                                 <p>Because unauthenticated identities are never authenticated by the user, they pose
                                    a much greater risk than authenticated Amazon Cognito identities. If an unauthenticated
                                    identity is compromised, it can use administrative actions to modify account
                                    settings, delete resources, or gain access to sensitive data. Or, with broad access
                                    to device settings, it can access or modify shadows and jobs for all devices in your
                                    account. A guest user might use the permissions to compromise your entire fleet or
                                    launch a DDOS attack with messages.
                                 </p>
                                  
                                 
                                 <h2 id="audit-chk-unauth-cognito-role-permissive-how-to-fix">How to fix
                                    it
                                 </h2>
                                 
                                 <p>A policy attached to an unauthenticated Amazon Cognito identity pool role should grant
                                    only
                                    those permissions required for a device to do its job. We recommend the following
                                    steps:
                                 </p>
                                 
                                 
                                 <div class="orderedlist">
                                     
                                     
                                     
                                     
                                    
                                    <ol>
                                       <li>
                                          
                                          <p>Create a new compliant role.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Create a Amazon Cognito identity pool and attach the compliant role to it.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Verify that your identities can access AWS IoT using the new pool.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>After verification is complete, attach the compliant role to the Amazon Cognito
                                             identity pool that was flagged as noncompliant.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                 
                                 <p>You can also use mitigation actions to:</p>
                                 
                                 <div class="itemizedlist">
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>Apply the <code class="code">PUBLISH_FINDINGS_TO_SNS</code> mitigation action to
                                             implement a custom response in response to the Amazon SNS message. 
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>For more information, see <a href="./dd-mitigation-actions.html">Mitigation actions</a>. 
                                 </p>
                                  
                                 
                                 <h2 id="manage-modify-things-check">Manage or modify things</h2>
                                 
                                 <p>The following AWS IoT API actions are used to manage or modify things. Permission
                                    to
                                    perform these actions should not be granted to devices that connect through an
                                    unauthenticated Amazon Cognito identity pool.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><code class="code">AddThingToThingGroup</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AttachThingPrincipal</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">CreateThing</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">DeleteThing</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">DetachThingPrincipal</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">ListThings</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">ListThingsInThingGroup</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">RegisterThing</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">RemoveThingFromThingGroup</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">UpdateThing</code>
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">UpdateThingGroupsForThing</code>
                                             
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>Any role that grants permission to perform these actions on even a single resource
                                    is considered noncompliant.
                                 </p>
                                  
                                 
                                 <h2 id="read-thing-admin-data-check">Read thing administrative data</h2>
                                 
                                 <p>The following AWS IoT API actions are used to read or modify thing data. Devices
                                    that connect through an unauthenticated Amazon Cognito identity pool should not be
                                    given
                                    permission to perform these actions.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><code class="code">DescribeThing</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">ListJobExecutionsForThing</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">ListThingGroupsForThing</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">ListThingPrincipals</code></p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <div class="example">
                                    <p class="title"><b>Example </b></p>
                                    <div class="example-contents">
                                       <div class="itemizedlist">
                                           
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p>noncompliant:</p>
                                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [ 
          "iot:DescribeThing",
          "iot:ListJobExecutionsForThing",
          "iot:ListThingGroupsForThing",
          "iot:ListThingPrincipals"
      ],
      "Resource": [
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:/thing/MyThing"
      ]
    }
  ]
}</code></pre>
                                                <p>This allows the device to perform the specified actions even though it
                                                   is granted for one thing only.
                                                </p>
                                                
                                             </li>
                                          </ul>
                                       </div>
                                    </div>
                                 </div>
                                  
                                 
                                 <h2 id="manage-non-things-check">Manage non-things</h2>
                                 
                                 <p>Devices that connect through an unauthenticated Amazon Cognito identity pool should
                                    not be
                                    given permission to perform AWS IoT API actions other than those discussed in these
                                    sections. You can manage your account with an application that connects through an
                                    unauthenticated Amazon Cognito identity pool by creating a separate identity pool
                                    not used by
                                    devices.
                                 </p>
                                  
                                 
                                 <h2 id="audit-chk-unauth-cognito-role-permissive-mqtt-topics">Subscribe/publish to MQTT topics</h2>
                                 
                                 <p>MQTT messages are sent through the AWS IoT message broker and are used by devices
                                    to
                                    perform many actions, including accessing and modifying shadow state and job
                                    execution state. A policy that grants permission to a device to connect, publish,
                                    or
                                    subscribe to MQTT messages should restrict these actions to specific resources as
                                    follows:
                                 </p>
                                 
                                 <div class="variablelist">
                                     
                                     
                                     
                                     
                                    
                                    <dl>
                                       
                                       <dt><b><span class="term">Connect</span></b></dt>
                                       
                                       <dd>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>noncompliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:client/*</code></pre>
                                                   <p>The wildcard * allows any device to connect to AWS IoT.</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:client/$<span>{</span>iot:ClientId}</code></pre>
                                                   <p>Unless <code class="code">iot:Connection.Thing.IsAttached</code> is set to
                                                      true in the condition keys, this is equivalent to the wildcard *
                                                      in the previous example.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>compliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [ "iot:Connect" ],
      "Resource": [
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:client/$<span>{</span>iot:Connection.Thing.ThingName}"
      ],
      "Condition": <span>{</span>
        "Bool": <span>{</span> "iot:Connection.Thing.IsAttached": "true" }
      }
    }
  ]
}</code></pre>
                                                   <p>The resource specification contains a variable that matches
                                                      the device name used to connect. The condition statement further
                                                      restricts the permission by checking that the certificate used
                                                      by the MQTT client matches that attached to the thing with the
                                                      name used.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </dd>
                                       
                                       
                                       <dt><b><span class="term">Publish</span></b></dt>
                                       
                                       <dd>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>noncompliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topic/$aws/things/*/shadow/update</code></pre>
                                                   <p>This allows the device to update the shadow of any device (* =
                                                      all devices).
                                                   </p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topic/$aws/things/*</code></pre>
                                                   <p>This allows the device to read, update, or delete the shadow
                                                      of any device.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>compliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [ "iot:Publish" ],
      "Resource": [
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topic/$aws/things/$<span>{</span>iot:Connection.Thing.ThingName}/shadow/*"
      ],
    }
  ]
}</code></pre>
                                                   <p>The resource specification contains a wildcard, but it only
                                                      matches any shadow-related topic for the device whose thing name
                                                      is used to connect.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </dd>
                                       
                                       
                                       <dt><b><span class="term">Subscribe</span></b></dt>
                                       
                                       <dd>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>noncompliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topicfilter/$aws/things/*</code></pre>
                                                   <p>This allows the device to subscribe to reserved shadow or job
                                                      topics for all devices.
                                                   </p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topicfilter/$aws/things/*</code></pre>
                                                   <p>The same as the previous example, but using the #
                                                      wildcard.
                                                   </p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topic/$aws/things/+/shadow/update</code></pre>
                                                   <p>This allows the device to see shadow updates on any device (+
                                                      = all devices).
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>compliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [ "iot:Subscribe" ],
      "Resource": [
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topicfilter/$aws/things/$<span>{</span>iot:Connection.Thing.ThingName}/shadow/*"
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topicfilter/$aws/things/$<span>{</span>iot:Connection.Thing.ThingName}/jobs/*"
      ],
    }
  ]
}</code></pre>
                                                   <p>The resource specifications contain wildcards, but they only
                                                      match any shadow-related topic and any job-related topic for the
                                                      device whose thing name is used to connect.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </dd>
                                       
                                       
                                       <dt><b><span class="term">Receive</span></b></dt>
                                       
                                       <dd>
                                          
                                          <div class="itemizedlist">
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>compliant:</p>
                                                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:topicfilter/$aws/things/*</code></pre>
                                                   <p>This is allowed because the device can receive messages only
                                                      from topics on which it has permission to subscribe.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </dd>
                                       
                                    </dl>
                                 </div>
                                 
                                  
                                 
                                 <h2 id="read-modify-shadow-job-data-check">Read/modify shadow or job
                                    data
                                 </h2>
                                 
                                 <p>A policy that grants permission to a device to perform an API action to access or
                                    modify device shadows or job execution data should restrict these actions to
                                    specific resources. The following are the API actions:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><code class="code">DeleteThingShadow</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">GetThingShadow</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">UpdateThingShadow</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">DescribeJobExecution</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">GetPendingJobExecutions</code></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">StartNextPendingJobExecutio</code>n
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">UpdateJobExecution</code></p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <div class="example">
                                    <p class="title"><b>Example </b></p>
                                    <div class="example-contents">
                                       <div class="itemizedlist">
                                           
                                           
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p>noncompliant:</p>
                                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:thing/*</code></pre>
                                                <p>This allows the device to perform the specified action on any
                                                   thing.
                                                </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>compliant:</p>
                                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [ 
          "iot:DeleteThingShadow",
          "iot:GetThingShadow",
          "iot:UpdateThingShadow",
          "iot:DescribeJobExecution",
          "iot:GetPendingJobExecutions",
          "iot:StartNextPendingJobExecution",
          "iot:UpdateJobExecution"
      ],
      "Resource": [
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:/thing/MyThing1",
        "arn:aws:iot:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:/thing/MyThing2"
      ]
    }
  ]
}</code></pre>
                                                <p>This allows the device to perform the specified actions on two things
                                                   only.
                                                </p>
                                                
                                             </li>
                                          </ul>
                                       </div>
                                    </div>
                                 </div>
                                 
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the Amazon Web Services Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="./audit-chk-ca-cert-key-quality.html">CA certificate key quality</div>
                                    <div id="next" class="next-link" accesskey="n" href="./audit-chk-auth-cognito-role-permissive.html">Authenticated Cognito role
                                       overly permissive
                                    </div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/audit-chk-unauth-cognito-role-permissive.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IoT Docs&amp;topic_url=https://docs.aws.amazon.com/en_us/iot/latest/developerguide/audit-chk-unauth-cognito-role-permissive.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS IoT Core';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>
</html>